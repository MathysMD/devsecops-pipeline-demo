# GitLeaks configuration for educational demo
# This configuration ensures detection of intentional secrets

title = "GitLeaks Configuration for DevSecOps Demo"

[[rules]]
id = "aws-access-key-id"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["key", "AWS"]

[[rules]]
id = "aws-secret-access-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws(.{0,20})?(?-i)['\"][0-9a-zA-Z\/+]{40}['\"]'''
tags = ["key", "AWS"]

[[rules]]
id = "github-token"
description = "GitHub Personal Access Token"
regex = '''ghp_[0-9a-zA-Z]{36}'''
tags = ["key", "GitHub"]

[[rules]]
id = "slack-webhook"
description = "Slack Webhook URL"
regex = '''https://hooks\.slack\.com/services/[A-Z0-9]{9,12}/[A-Z0-9]{9,12}/[A-Z0-9a-z]{24}'''
tags = ["webhook", "Slack"]

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey|secret[_-]?key)['"\s]*[=:]['"\s]*['\"][0-9a-zA-Z\-_]{20,}['\"]'''
tags = ["key", "generic"]

[[rules]]
id = "password"
description = "Password in code"
regex = '''(?i)(password|passwd|pwd)['"\s]*[=:]['"\s]*['\"][^'\"]{8,}['\"]'''
tags = ["password"]

[allowlist]
description = "Allowlist for false positives"
regexes = [
    '''example\.com''',
    '''your-api-key-here''',
]
